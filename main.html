<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="utf-8">
<title>Drive Folder Test</title>

<script src="https://accounts.google.com/gsi/client"></script>
<script src="https://apis.google.com/js/api.js"></script>

<style>
body{font-family:sans-serif;padding:20px}
button{margin-right:10px}
pre{background:#f5f5f5;padding:10px}
</style>
</head>
<body>

<h3>Google Drive Folder Test</h3>
<button onclick="login()">Login Google</button>
<button onclick="createFile()">Create test.txt</button>

<pre id="log"></pre>

<script>
/* ===== CONFIG ===== */
const CLIENT_ID =
"740899492808-qoi3pjpfbe2sp8e8e4q43tr2sm0cnuhl.apps.googleusercontent.com";

const FOLDER_ID = "1PQWNipWJ3f6HvS_g8j3eC4_eKJ7NVC79";

const SCOPES = "https://www.googleapis.com/auth/drive.file";

let tokenClient;

/* ===== INIT ===== */
gapi.load("client", async () => {
  await gapi.client.init({
    discoveryDocs:[
      "https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"
    ]
  });
  log("GAPI ready");
});

tokenClient = google.accounts.oauth2.initTokenClient({
  client_id: CLIENT_ID,
  scope: SCOPES,
  callback: token => {
    gapi.client.setToken(token);
    log("Login success");
  }
});

function login(){
  tokenClient.requestAccessToken();
}

/* ===== TEST CREATE FILE ===== */
async function createFile(){
  const body = "OAuth User Drive Test OK";

  await gapi.client.drive.files.create({
    resource:{
      name:"test.txt",
      parents:[FOLDER_ID]
    },
    media:{
      mimeType:"text/plain",
      body
    }
  });

  log("สร้าง test.txt ใน Folder สำเร็จ");
}

function log(t){
  document.getElementById("log").textContent = t;
}
</script>
</body>
</html>
